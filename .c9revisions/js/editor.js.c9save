{"ts":1357169777608,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var Editor={\r\n\r\n\tmenu:[],\r\n\tmapCode:[],\r\n\tinitalized:false,\r\n\tinit:function()\r\n\t{\r\n\t\tthis.initalized=true;\r\n\t\tfor(k in items){\r\n\t\t\tvar itm=items[k];\r\n\t\t\tif(typeof this.menu[itm.scenario] =='undefined'){\r\n\t\t\t\tthis.menu[itm.scenario]=[];\r\n\t\t\t}\r\n\t\t\titm.name=k;\r\n\t\t\tthis.menu[itm.scenario][this.menu[itm.scenario].length]=itm;\r\n\t\t}\r\n\t\t\r\n\t\tvar html='<select class=\"menu\"><option>Select scenario</option>';\r\n\t\tfor(k in this.menu){\r\n\t\t\thtml+='<option onclick=\"Editor.loadScenario(\\''+k+'\\');\">'+k+'</option>';\r\n\t\t}\r\n\t\thtml+='</select>';\r\n\t\t$('#mapEditor').prepend(html);\r\n\t\t\r\n\t\t$(\"#myPlayer img\" ).draggable({ containment: \"#currentMap\", obstacle: \".mapSprite\", preventCollision: true });\r\n\t},\r\n\tloadScenario:function(scenario)\r\n\t{\r\n\t\tvar html='';\r\n\t\tfor(k in this.menu[scenario]){\r\n\t\t\tvar itm=this.menu[scenario][k];\r\n\t\t\thtml+='<div class=\"mapSprite pointer '+itm.name+'\" onclick=\"Map.addItem({name:\\''+itm.name+'\\',x:55,y:40});\"type=\"'+itm.type+'\"></div>';\r\n\t\t}\r\n\t\t$('#items').html(html);\r\n\t\t$(\"#currentMap .mapSprite\" ).draggable({ containment: \"#currentMap\", obstacle: \".mapSprite\", preventCollision: true });\r\n\t},\r\n\tgenerateMap:function()\r\n\t{\r\n\t\t$(\"#currentMap .mapSprite, #currentMap .player img\").each(function(){\r\n\t\t\tvar name=$(this).attr('name'),\r\n\t\t\t\tx=parseFloat($(this).css('left').replace(/[^-\\d\\.]/g, '')),\r\n\t\t\t\ty=parseFloat($(this).css('top').replace(/[^-\\d\\.]/g, ''));\r\n\t\t\t\t\r\n\t\t\tif(typeof name =='undefined'){ //if doesnt have name, it should be players div\r\n\t\t\t\tname='playerPos';\r\n\t\t\t}\r\n\t\t\tEditor.mapCode[Editor.mapCode.length]={\r\n\t\t\t\tname:name,\r\n\t\t\t\tx:x,\r\n\t\t\t\ty:y,\t\r\n\t\t\t};\r\n\t\t});\r\n\t\t\r\n\t\tif(Editor.mapCode.length>1){\r\n\t\t\tif($('#mapEditor textarea').length<1){\r\n\t\t\t\t$('#mapEditor').append('<textarea>'+JSON.stringify(Editor.mapCode)+'</textarea>');\r\n\t\t\t}else{\r\n\t\t\t\t$('#mapEditor textarea').text(JSON.stringify(Editor.mapCode));\r\n\t\t\t}\r\n\t\t}\r\n\t\tEditor.mapCode=[];//reset\r\n\t},\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":1885}]],"length":1885}
